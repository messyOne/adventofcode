object Main extends App {
//  val input = "COM)B\nB)C\nC)D\nD)E\nE)F\nB)G\nG)H\nD)I\nE)J\nJ)K\nK)L\nK)YOU\nI)SAN"
  val input = "VZ3)KYR\n71B)KMC\nRST)B6X\nT9P)91Q\nWLC)PGY\nKGW)6B2\nCYZ)B1P\nNQ8)SHS\nJ94)4KP\n4ZV)GB9\nCDS)NVS\n26G)KFS\n3QS)Z5D\nN5M)WRF\n97Y)8F1\nV4H)PH6\nQTK)CS2\nCCC)Z2Y\nKTK)GV6\nZ2Y)92Z\nM9G)ZJ4\nKKC)Y7M\nV4X)WKQ\nT8V)1Q3\nVBQ)25K\nSY7)YVY\nBZ3)2VD\n6ZG)2TP\n3NY)JSV\nNPB)HQL\n3F4)92P\n3SB)R49\n5P4)LYK\nVKW)8LV\n8LS)814\n26W)17Z\nC4W)X2T\nXX9)Z4W\nVXG)54T\nLZN)D19\n4SL)8LY\nV4J)HPN\nYHV)M6D\nF7R)PYG\n5FX)CSR\nQVT)4M4\nL2S)6CB\n58X)3DY\nPK7)JH4\nSGK)WS4\nXMQ)3F8\nGFB)QHW\nRNM)9V5\nZBQ)THN\nXLX)YX1\nHDJ)T5P\nKFS)NQ8\nP4Q)Q47\nJP3)WJY\nDT6)C9P\nMW5)CXF\nD5S)FC4\n1ZD)MHD\nYZT)BFJ\nDNV)JSY\n8WZ)YQ7\n25L)M5R\nY8M)QFJ\n7L3)BNK\nGLD)3X8\n5SG)91M\n1BQ)5MG\nBZT)ZK2\n167)8V9\nC3Y)1YY\n85M)CRV\n469)RST\nRWS)KCK\nRL2)CQQ\nYBV)Q7S\nDTS)T8W\nLBT)FQ2\nSGZ)V5F\nPJZ)MHK\nTZJ)JCL\nY63)N5M\n79F)CX6\n21X)97Y\n41J)QVD\nJGF)DNV\nTSJ)TX3\nRJF)MRL\n9BF)WHY\n7HB)TZV\nW9W)3PY\nK1X)YZ8\n19H)769\nCJG)6TP\nYZC)R9Z\nCL7)V81\nG7M)RN1\n2XG)9HG\n1DN)Z89\nSTM)6XV\nLW2)34W\nQPH)MZP\nDV5)3WK\n86B)M8J\nFLC)KKN\nFB9)4Y5\n2T6)RW7\n4JN)PJH\n4KP)HNF\n278)B48\nN7K)1JD\nWJZ)RWS\nRWS)G5Q\nJDP)YNV\n17L)G6N\nVJN)LQP\nRN1)76J\n278)T7F\nHQL)FQN\nJTT)JK9\n91M)8KG\nG49)9NF\nDWP)RGR\nYXL)2N3\nQM8)B18\nMG2)S7P\n81M)K6Z\nN7Y)FGQ\nFQN)15F\nWSQ)41G\nFJ5)TZJ\n4QK)88V\nDGZ)P29\nWQX)C1F\nRZD)25L\nJH4)JGX\nDPB)8Z5\n3RK)1BQ\nWLQ)CV3\nF52)QXC\nHYQ)KBX\nW29)JTT\nK54)RZ4\nQHS)VR4\nT1M)888\n635)F8W\n17Z)95B\nYV7)KR1\n4FX)D2T\nHBR)SP9\nS7G)LYN\nFDM)BCL\nQJG)F12\nV5M)Q66\nY9G)7SB\nK3V)GC4\nR8H)HLD\nMZY)K72\nK6N)XHS\nN7C)ZS9\nCKC)LD8\nFCY)K3T\nBBS)HNG\nPFR)2YJ\nLVD)YXR\nPM4)ZGK\nL17)DV5\nQM1)LJ7\nFMW)ZPX\nK7C)5MQ\nH5M)HJ5\nYHV)YGJ\nCC2)XW3\n1P1)FKX\nJ5D)5DP\nW74)RFS\nKCK)5SG\nCSG)QBX\nZ86)PCP\n248)2CP\nXDK)7X6\n2YJ)2Y3\nM81)JCF\nLL4)QTK\n5JF)DGQ\nQYM)QRZ\n9L6)DLC\n529)R5C\nMWH)8PP\nDWL)7QR\nY4B)TP2\n5SL)W29\n7XN)YF5\n1JV)LH5\nGWJ)RCJ\nFCS)5P7\nZFQ)57Q\n8NL)GG5\nN55)DM6\nNYG)YXN\n3NX)YZV\nNND)WTK\nD6F)GWJ\nH3C)9M1\nTXS)P2C\nNH2)343\nX22)CKC\n1JH)G24\nFQ2)DWW\nPZ2)DW7\nS1H)5KG\nKTG)5NM\n3KW)FWW\n22M)YDY\nYFF)DDY\nBD8)3WQ\nCS2)SXJ\nJ31)DG2\n4DC)PLL\nDMC)RX9\nVQ4)GDX\nRX9)CL7\nVTL)NL3\nGQR)SCL\nYZF)HQK\n4LC)LQD\nJLS)FMW\nDSQ)W6Q\nBV7)RLM\nT7F)S36\nRMR)CBH\n5Y7)T9P\nXR3)Z81\n965)WDG\nMZC)8KN\nGTL)HQN\nRDH)Z99\n9NF)4FX\nX33)SN6\nL88)LZG\n9HG)56V\nVWB)BD8\nQ1M)17L\nNNH)YK1\nSFK)N9N\nKRZ)2LF\nF5B)6W9\nM9C)1NP\nZS9)JQS\nM27)Y32\nSQ6)RVV\nDGQ)WW4\nM8F)P3Q\n7YJ)X58\n8V9)7L3\nGS7)VZ9\nRZV)NS2\nFKJ)4WF\nYV8)646\n6JH)88Q\nLW5)5Z7\nDW1)26W\nWN2)CWD\n24F)CBN\n4TC)Y7Z\nSGG)73D\nQ7M)MDS\nGYM)ZH3\nC5B)SWB\n3W2)F6V\nQZD)PXP\n2TP)4CR\nCX6)SNV\n6T1)GGD\nS3S)CPF\nCZ5)3NQ\nZSM)57R\nF5B)MKM\nVM8)64G\n4CW)X33\nDJW)J5D\nLLW)8ZF\n21G)G6C\nXGZ)81M\nXVQ)TZH\nFGQ)NPV\n2HN)DR9\nNSK)7BC\nKH2)278\nGH2)1DD\nJVM)154\nWQ6)2DN\nJD9)DSQ\nSJX)33W\n37N)7W6\nJV3)KTG\nSRG)NWN\nGJQ)9J9\nNFF)46K\n5HD)ZJY\n8T6)Q59\n2CT)T59\nFH7)4XY\nC5B)7XX\n9L6)YBV\nCQQ)17R\nHJ5)JDP\nFTL)4DD\n7KW)MZC\nHVV)P63\n7WM)46M\n39Z)LRV\nPYG)LYP\nDM6)FS8\nKDZ)S7X\nNVS)Y4H\n37V)573\nZS1)83C\n9DM)Y8G\nM5R)HYT\nWTK)529\n67D)LC5\n4WF)564\n7K6)MKL\nVZN)Q17\nGNP)7XN\nJLY)B86\n8Z7)XSK\nY8M)QBD\n6NX)XD2\nTX3)JVM\nX4N)62D\n61P)44Y\nJ35)ZWX\n7PT)S3S\nFWW)Y6J\nWLN)2BP\nY1T)GLD\nF8W)CKT\n7LH)S2J\nBFJ)XMQ\nZ7P)2XG\nY89)886\n5K8)5FW\nJP1)QQL\n2P1)635\nZDD)2HN\nNH6)CY7\n8Z4)1JV\nNJC)CRZ\nGXB)1RB\nW1F)G2W\n76P)GF8\nB8X)F52\nTM1)HJT\nX6J)P1C\n1XD)WDQ\n4D1)NNH\nTS5)FRL\n6LX)17G\nL5F)QM8\n84Q)RH8\nCTF)72Y\nXGJ)39Z\nW7F)9L6\nQNQ)MR9\nH31)QQV\n8LY)ZFH\n26H)BZ3\nK6Z)X5T\nM4N)9NV\nY2Q)WQB\nWVZ)VWB\nJB4)HQR\n6VJ)2D8\nMCN)SGZ\nYNG)1DS\nP4Q)QHS\nKBW)BH9\n51Y)M44\n8KG)JWX\nM81)PKQ\nVTN)K54\n4KV)BJH\nDPR)GHC\nSFM)T1P\nJCF)2S6\n1L2)8W1\nXN8)HVM\nGCW)2BH\nKNQ)P51\nX9H)G49\nL19)S7G\nLSC)VB8\nG4S)JHN\n44C)9RL\nPR9)7RD\nDQC)VZ3\n8HH)WST\nTJM)8Z2\n88N)3QP\n5YC)7GR\nV7Y)S5J\n67F)8LS\nYDY)Z5X\nLSB)K1L\nDX1)G3X\n1MV)S3Q\n9YT)NX2\nQM3)CJG\nWJY)28T\nJKJ)KWC\nH8S)CYZ\nLPN)D3L\nMZ4)65Y\n7LK)WPB\nZNH)W9C\nHR9)NH2\nLM4)22M\nL2S)N76\nV6X)QFR\nS47)SGG\nN2Z)XLX\n6QR)84Q\nC6P)Z7P\nRFS)Q61\nNX2)H5Y\nG6V)ZSM\nRGX)1Z2\nXN8)MZN\nD4Y)NMN\nK4Q)V8Z\nN46)RH6\nF1N)WC8\nD3L)LM4\nK9Q)469\nC9C)72P\nZ78)X6R\nBML)2N2\nSWB)6YY\nP63)N3J\nWSH)47C\n7GR)2QR\nD2T)BC6\nLG4)7BN\nX5X)8BB\n5YR)215\nT59)TRF\nT1P)NC8\n24R)M9B\nZZ3)1SX\nH88)PZ2\nMR9)CDT\n5CZ)9GC\n7YB)RGX\nRLW)HYH\nNYK)X3Y\nH5Q)PYD\nYXR)TM1\nK4Q)BQB\n9VY)32D\n1P1)8BM\nMHK)J3P\nZFQ)FV2\n2MJ)XFJ\nFC4)32C\nSBQ)HLZ\nLYK)WN2\nL23)WZ9\n1BZ)ZWB\nYK1)HMJ\n489)CWP\nVS8)HYQ\nPCP)281\nF41)J94\nQHX)KZ1\n69L)4M5\n9P1)62P\nPY2)DQV\nBLH)M27\n3K5)QZD\nY96)PKC\nQQP)HDS\nTGD)HD1\nYQT)N33\n4HB)TX4\n7BC)K59\nP13)9ZQ\nMP3)67F\nW9C)KN6\n9XM)LW2\nZ89)JV3\nH3J)XGZ\n4KV)TP4\n233)NH6\nGGD)YV8\n3PW)DVH\nV81)4N7\n7X6)4VB\nN28)ZCL\nJLS)4JN\nQ59)F41\n5LN)P9G\nWDG)ZH9\n8BB)GTG\nS7P)JZ7\nYB6)WXX\nVCM)M1S\nFVG)51Y\nCWK)VG8\nP96)VQ4\nGS7)LLW\n313)5NV\nZPG)H5M\nL2V)GJS\n2C3)N28\nJYN)2S4\nKPC)H3C\nJZ7)HV8\n88N)3JQ\n6DD)THF\nMQS)ZBQ\n1DD)3KD\nL6D)QRT\nL96)KBK\nFS8)KTK\nGHC)6DD\nTJL)N3H\nYR2)W7F\n1Q3)TGD\nP85)JD9\n97P)CH1\n215)Z7V\nPG3)7BF\nJN8)7DM\nS3Q)NYK\nQTH)ZS4\nXDT)N7K\nD6T)4SL\nS3S)227\n2ZW)X5R\nRH8)P8D\nFMQ)YZT\nRTT)PNL\n5P7)1QH\nKZ1)8Z7\n2LS)HRX\nZG6)K7K\n7LH)3RK\n4N7)V4J\nZYG)L88\nBXK)GWP\nKVF)KH9\nS2J)L2S\nZ4Y)241\n32C)FH8\n5BY)WSQ\nTHF)HTQ\n573)SFX\nVXY)1GQ\n7J9)FCS\n2TF)FCY\nZYP)C3Y\nXQ1)H5Q\nZGD)313\n2WF)SFM\n1SX)YNG\nCNT)QNQ\nM65)3F9\nCRL)2TF\nLK4)TS5\nDB6)PWW\nNPV)7JQ\nQ3N)WYH\n1CK)JMJ\nHY8)2ZW\nZ78)HTV\nS5X)V7W\nB18)Z6F\n718)VF8\nQ7S)7YJ\nW73)1MC\nYZX)YPW\nYC8)SGY\nHMJ)DPB\nG8H)2FD\nK59)5K8\n245)DQC\nZX4)FV9\nHNG)9QK\nSVT)SB2\nJF8)2M8\n7K7)CHJ\nKBV)DCV\nKDQ)446\nVMJ)8SL\n26D)Y63\n9Q9)X2R\nKMC)5XT\n2BH)NKG\nMH8)954\nVJD)7YP\n2QR)D9B\n9PJ)Y89\nTZ4)W9Y\n397)TZK\nZPR)WLN\nJNY)2ZV\nCVM)4V7\nXWM)NPG\nTZK)8NL\n1YJ)PBG\n4CB)16R\nC4C)88N\nCBH)X6J\n281)GWC\nY1J)965\n6W4)8YF\nR2L)XN3\nSP4)8ZW\nTML)PDM\n2MQ)NFF\nZJ4)V5M\nCXF)26H\nXRG)WNM\n7XX)PL5\n9V5)7GJ\n5NM)9PJ\nRQ5)GMY\nBQB)VXG\n154)99Q\nKKN)7WM\nK3P)YOU\nK2R)YZC\nM3P)489\n4XX)CWK\nLRV)D4Y\nHW5)MFD\nYM3)S1H\n5DP)8ZJ\nTKC)YNQ\nKZ1)KG7\nCOM)7J9\nLZW)4PS\n6TP)38J\n3JZ)KBZ\nYM4)X9H\nN5Z)X1V\nKR1)1TT\nB1P)TZ4\nG7Y)FHX\nTNN)4CN\nLC5)PK7\n241)MP3\nHQR)K6G\nPLL)BBZ\nFBD)VRG\nLJ7)1ZR\nJCL)YM3\n47F)9W6\n7BN)TML\nHYT)HC8\nZ4W)C9C\n6HC)JH7\nZ6X)J35\nDQ1)D8B\nRLM)D6Y\nK73)47F\nWPB)TH6\nCJT)WLQ\n67D)L9S\nY5X)J44\nNBQ)2FB\nTX3)Q5R\nCH1)565\n2S4)PSV\nHSY)QHX\nV5R)Y71\nYQT)1XD\n1DS)J5Z\nJH7)MGW\n7SB)WSH\nPX3)56Q\nZPX)H57\nTP2)6XX\nWC8)M65\nH1L)GJQ\n7JQ)FB9\nX5R)CC2\nGWP)QPX\nFC4)MQS\n8SL)TK9\nPKQ)KNC\nPBN)2LS\nNT9)PJZ\n2FD)HR9\nRZ4)CTF\nHQN)BTP\n4N7)NSK\nDVK)928\nZPP)XWM\nC57)LLC\nDFV)H3J\n92M)L17\n8D7)B68\nD19)MC4\nC6D)QM1\nQVD)Z1M\nDVR)71B\n17R)6HD\nC1F)74Y\nJ5Q)41J\nS5R)9BF\n1YY)G8H\nVRK)F93\nYQ7)ZG6\nL8G)HT1\nBRJ)SHP\nRVV)WX4\n4QM)4DC\nJSV)YR2\nYDZ)K31\nXHS)L6D\n8LV)8T6\nNVR)775\n5JQ)SWZ\nD5G)R5K\nZFH)YP1\nCQY)K4Q\nLRD)718\n1DM)ZS1\nP29)12D\nWXX)8DK\nL4M)3B7\nRZH)ZZ3\n76J)S5X\nPYD)QQB\nNC8)GCH\nHRX)4QK\nGQ4)69L\nZHQ)F1N\nMRL)21G\nV62)1C9\n3JQ)HY8\nQKB)1L2\nWY9)ZDD\nCWZ)HMF\nFV9)MZY\n2M8)W7J\nQXC)YBT\nN33)DJW\n74Y)95T\n62P)YKY\nYP1)2MQ\n22M)3C5\nDVJ)JS4\n9NF)4KV\n17G)L4M\n63Y)1P1\nBC6)VBQ\n7CW)PQG\n6W9)WRJ\n97Z)81B\nVPP)3NX\nVNM)KYB\nQCB)BF6\nCKT)1ZD\n2BP)VMD\nZQD)QM3\nGDV)KN1\n2HD)25Y\nY4H)HZ5\nKN6)4D1\nPKQ)LSC\nJS4)L86\nMX6)B51\n9MD)3LR\n2VD)LCD\n7RG)GQR\nVB8)4CW\nYLL)3SB\nYBT)GTX\nB6Z)Y8S\n1YB)JLS\n5SL)BTH\n3KD)PL9\nYNQ)JFL\n3T2)VYV\nZWB)62C\nJ3N)39T\n5Z7)J1R\nWYY)D6T\nYX1)RTT\nP94)6T1\nJMJ)MH8\n1RB)ZGD\n7DM)4QM\nQFG)CMY\n7KY)CT1\nX9S)J6D\nPBN)3PW\nRT5)Q7M\n8BM)9YT\nTHN)JWN\nDVH)JLY\nN7L)F7R\nGDX)CRL\nC7Z)7KW\nTK9)NM3\nHYG)7K7\nQVP)71T\nDV7)1YH\nTZV)Z6C\nKBL)QK1\nW7J)Y8M\nJNL)JP1\nKR1)L2B\nX1K)21L\nB26)ZPR\n3QP)LZW\nZ1M)TNN\nWHY)THJ\nYNV)ZHN\nLV9)JNY\nJWS)V4Q\n1LZ)PBN\n58F)HYG\nBT7)7PD\nY8S)WQX\nQ66)2MJ\n769)KYK\nFLH)1JH\nFCB)G35\nVML)JRL\nDGZ)Z86\nPWJ)63G\n3VF)2T6\nHJZ)L8G\nNPG)CJC\n7T4)4N1\n9QK)KPC\nQQL)NHX\nL6L)91S\n81B)TXS\n25Y)KBV\n4QQ)H74\nFB9)NVR\nQN3)VTL\nQTH)P96\n1C9)D9Q\nMFD)F5B\n343)9D6\n9GQ)V62\nSTM)X88\nM9B)GQ4\n4V7)CS4\nJFL)3WG\nJPV)6H5\nXJC)C5T\nCRZ)W74\nXLZ)BRJ\nL86)4FH\n1DD)WSR\n182)1BZ\nDNN)FVQ\n9M1)PG1\nM9B)58X\nD6Y)J4H\nPDM)QPQ\nGMY)LF7\nYXX)37V\n4R5)KXL\nFHX)NPB\nCHJ)PYM\nZWX)V5R\n9BV)ZDW\nD9Y)HVV\nTJM)79C\nPKC)BW5\n3T5)61P\nW6Q)1LZ\nCVB)1SN\n8TV)8QB\n52B)WK2\n886)HYC\nXTP)WJZ\n6B2)PWJ\nSH2)ZLH\nPTZ)VS7\nCMY)8D7\nJK9)67D\nGTG)BXK\n4RG)8Z1\nPNL)J3N\n62C)VRK\nHBR)3QS\nZK2)64K\nS7X)P59\nQDC)6XD\nHTQ)7ZV\nQ8R)Y4B\nBNK)JMC\n2QR)Z78\nZH3)2G5\nYSB)1MV\nX58)KKC\nV4J)JTC\nYPW)FLH\n8YF)RZX\nN46)FFK\nLSB)Y4Y\nL36)B6Z\n4PS)RZV\nD9K)STM\nRCJ)D9K\nWYH)V6X\nY6J)3DW\n2T8)PX3\n2N3)1DN\n64G)3JX\nQBX)7T4\n3VF)HJQ\nWK2)21X\nZGD)6K6\nG9F)K4V\nLQH)638\nJFF)GLT\n5S4)9XM\n8DK)2HD\nNL3)LG4\n92P)VRW\nBGF)5BY\n3QS)YQT\n81M)ZPG\nYKY)GNP\nP9G)6VJ\nFK1)F22\n64K)YKL\nPSV)397\n3LR)P78\nNM3)6NX\nHD1)RWB\nR11)963\n4HK)B96\nLNL)4QQ\nNMZ)2R8\nMGW)XT2\n9GC)3T5\n8WX)1C1\nG7M)MTB\nQ47)LNM\nBNK)GK3\nSCL)RYF\n4VB)182\n6H5)PY2\nQHX)BBS\nRSX)2TH\nGY2)Y2Q\n47C)C72\nMPF)VHF\nSML)DWP\nJHN)XLZ\nN3J)XDT\n9W6)H3L\n78B)SP4\nTN1)6ST\n9VW)YXL\nD6B)6QR\nQZC)YDZ\nDT6)8HH\nWNF)ZNH\nRTT)44C\nTJR)JNL\nMK7)8TV\n658)QFG\nDWW)RMD\nZWF)QVP\n9JB)6JH\nJSY)NYG\nYC6)HDJ\n2N2)TJR\nHTK)FCB\n1NP)LKM\nQRT)ZFQ\n91Q)PV7\n689)VMJ\n21L)ZHQ\nZTD)XQ7\n7GR)CFW\n58X)4R5\nWGC)WDZ\nG2W)2P1\nDQF)LW5\n725)C6P\n3LZ)6FJ\n3JX)TKY\nJL1)SGK\nJMC)7LQ\n5MF)TMD\n1FP)1Y5\nMXK)Q1M\nDB4)DVJ\nBCL)6VS\nB96)ZQH\nFLC)B73\n2R8)F8N\nBBZ)B8X\n88V)X1K\nXSX)6C8\nZVP)RBT\n634)NVJ\n8Z2)DMC\nS5J)J5Q\nD28)25F\nMZP)9MS\n1JD)W7B\n7W6)N71\nBTP)5YC\nCSR)KH2\n6XD)LZB\n8HT)VJD\nZ7P)GLR\nQHW)3J7\nZS4)NT9\nGDX)L36\nL9Q)WY9\nBTQ)MG2\nDR9)YZS\nZ6F)PHM\nLYP)BFW\nZJY)PG3\nPQG)1CK\n92Z)P85\nM6N)KNQ\nMMT)H88\n8S2)M8F\n7LQ)3K5\n2LF)6LX\nL3X)R55\n6ZZ)QFB\nBFW)W9W\n62P)S47\n8X2)K73\nY32)NMZ\n34W)XGJ\nGB9)93G\nPNV)Y1T\n63V)7LH\n3SD)VM8\nN76)VZN\nDV5)L2V\nN6K)K3M\n4DD)YZG\n16R)L5F\n7BF)GCW\nZCL)KRZ\nRML)7KY\nRQ4)8PK\nX1V)2T8\n3WK)79F\nGWC)PTZ\nZDW)ZQD\n3WG)HSY\nRWB)DTS\nC72)KVN\nB48)C6D\n4N1)WP6\n6YY)97P\nXYT)XRG\nGF8)F8C\nXFV)9DM\n1C1)QVT\nWP6)R2L\nSHP)BLH\nJ1R)6HG\n12D)ZS8\n4BW)D9S\nZGK)6Q7\nHYH)GFB\n7PB)233\n6HD)Q3N\n4M5)B84\nNSK)7YB\nNPV)5S4\n4RR)CVB\nQK1)1YB\nXZJ)7K6\nWWJ)ZPP\nLQD)PS3\n33W)XFV\nK6G)KKR\nCXW)658\nK7C)5Y7\nMHD)56G\n2CP)41X\nHLD)HBR\n92B)NBQ\nPWW)R6X\nR55)6DR\nG35)PM4\nVG8)D5S\nQNT)DT6\n6GC)DV7\n91Q)DJ6\nT1M)4G5\nJFP)XVQ\nWDS)CJT\nJWX)NYQ\nNPS)TCR\nXPC)331\nP8D)JPV\nZ99)N55\nTHJ)YV7\nJTC)VJN\nZQQ)JR9\n25Q)5TF\nXD7)WNF\n2TP)MYL\nCFW)XXX\n88Q)KVB\nNT9)TJL\nJR9)7HB\nL6Y)H24\n4M4)WVZ\nTLV)MXK\n4CN)S5D\nR49)DX1\nYD1)8HT\n8F1)X51\nKX9)CBY\nL2Z)M6N\nKNC)9GQ\nNMG)Y9G\nJCB)BCB\n8Z1)XX9\nLCD)5TV\nB73)B26\nXV5)MG3\n3J7)KDQ\nBJH)CSG\nZHN)3JZ\nS5D)VML\nC9P)DXF\nHJZ)9BV\n46K)3SD\nHV8)FJR\n3F8)N6K\nKHR)9TR\n5TF)DPR\n5K8)QNT\n3T2)BTQ\n25K)KY3\n6CB)K7C\n1SN)C5B\nX87)RLW\nD9S)6GC\nC81)SML\n8W1)SQ6\nK72)XSR\n6XV)C7Z\n5KG)LZN\nWST)6PZ\nW9Y)4K1\n3F4)9VY\n2ZV)QMK\nRLM)Z3P\nYZV)248\nRBT)MZ2\n7CW)JFP\nR5K)LV9\nVZ9)QCB\nL2R)C4W\nVRW)QN3\n72Y)25Q\nZH9)3NY\nMYL)G4S\nHT1)L19\nXSK)9JB\nX13)4RG\nHDS)BML\n7K6)92B\nV8Z)GY2\nPKC)XQ1\nQ61)RNM\nZ6C)6W4\nCJC)28Q\nZQH)LNL\nCY7)PJD\nJ6D)ZYG\nTCR)WYY\nL2B)5JF\nB6X)8X5\n3Z2)4BW\n5VG)L2Z\nW9Y)725\nJQS)76P\nG6V)VS8\n56V)DNN\nCBY)7RG\nBF6)LFF\nYGL)L6L\nXLX)23P\nKH9)5YR\nKVB)XN8\nYF5)SFK\nNP1)YXX\n3B7)CXW\n6DR)2SK\nY8G)X87\nVWG)CWZ\n15F)BT7\nFQP)3LJ\nV4Q)QHR\nVL3)N46\nPGY)ZYD\n87K)RR8\nQQV)PR9\nYGJ)D6B\nSFX)9VW\n5V4)6M8\nKH3)G7M\nB84)VWZ\nZFH)H1L\nVMJ)MGL\nMYD)VCM\n1ZR)XDK\nTC1)YLL\nRQM)FY9\nL8M)F2H\nJM3)WHF\n9NV)68F\nFND)D9Z\n6LH)QPH\nF8N)ZTD\n6XX)N2Z\n4FH)YCF\nWZ9)F5R\nBH9)CNT\n5MQ)X4N\n62D)FTL\nX6R)7HW\nDQV)9BS\nH3J)R8H\nCNT)DQF\nPYM)9P1\n9F9)8WZ\nZB5)KH3\n2FB)JL2\nPS3)BZT\nYKL)XPC\nY7Z)DB6\n11D)JWS\nJVD)SH2\n775)YC8\n9NV)7CW\nQ17)MYD\nTH6)KBL\nYKS)NJC\nX51)5HD\nRZX)QM2\nFV2)CQY\nQFB)K2R\nK3M)3F4\nQ5R)7PT\nRH6)BGF\n8PP)JF8\nV4Q)58M\nX88)4HB\nX2R)4HK\nHY2)YSB\nHJT)G7Y\n76J)YM4\n6Q7)1YJ\nFCS)RDH\nDR3)C81\n4Y5)HV6\nTP4)S5R\n5NV)5VG\nH24)SRG\nXD2)63Y\nXYS)LPN\nJ3P)L9Q\nCPF)VL3\nQPX)58F\n8ZF)T2K\n9BS)9CP\nHLC)GYM\n68F)24F\n7JQ)6VM\n2DN)NNQ\n1WV)QDC\nL9S)L3X\nXQ7)Z6X\nDG2)DB4\n3F8)QJG\nLKM)YB6\nQFR)SJX\nTST)YC6\nQQB)JGF\n7HW)C57\n9S6)JB4\nZ81)X5X\n7PD)5FX\nPH6)26G\nYCF)B9B\nPL5)V7Y\nCBN)JM3\n3NQ)JKJ\nLLC)JYN\nG5Q)82W\nF5R)44D\nVMD)X9S\nF2H)W1F\n2Y3)DVR\nNYQ)B9T\nDCV)FMQ\n8MY)V4X\n93G)CZ5\nSNV)DHX\nX9H)DFV\nQFJ)L6Y\nSQ6)K9Q\n25F)TST\nWW4)FQP\nZWH)9MD\nWNM)D5G\nK7L)4CB\n56G)7LK\n2S4)ZVP\n6VM)RQ5\n8Z5)D28\nG6C)RQ4\nGLR)5KF\nY4Y)MPF\nMC4)L2R\nJPV)L23\n1Y5)GPH\n23P)WDS\n99Q)DR3\n7RD)78B\nJQS)MX6\nVKL)3FK\nP51)HPL\nSGY)4SH\nQRZ)MB1\nP59)6TM\nFH7)MMT\nQHR)1DM\nH3L)XBS\nMGL)1WV\nWKF)92M\nR9Z)X22\n286)167\n7ZV)H9C\nQFR)97Z\nMKM)W73\nLZB)TLV\n57Q)26D\n47F)FLC\nVHF)G7V\nPLL)VTN\nNMN)2WF\nSWZ)DVK\nKBK)NGD\nB68)ZQQ\nBBZ)HV2\n814)52B\n5MG)HQW\nCDS)5CZ\nPL9)JN8\n3C5)GH2\nSBZ)RJF\n5KF)MZ4\n41G)M6C\nHTV)4LC\nH5Y)7PB\nMWH)XV5\nRR8)VKL\nXSR)XD7\n3DW)4ZV\nWHF)2TL\n4G5)P4Q\nVPP)LBT\nKWC)V9D\n888)GS7\nC5T)5V4\nWKQ)8Z4\nMKL)HJZ\nKBX)VPP\n2PT)XYS\nY71)K3P\nRYF)KHR\nHPN)XJC\n65Y)5P4\nN3H)CT6\nB51)KGW\nF93)6ZG\n9RL)V4H\nM44)5Q1\nJMJ)T1M\n2TL)RQM\nLF7)SBQ\n227)ZB5\nXBS)HW5\n9NZ)YKS\nFFK)85M\n1QH)VWG\n4SH)9F9\nJWN)6C2\nVB8)3T2\nJL2)Y1J\nLYN)RX3\nDQ1)LQT\nNHX)YXW\nWS4)TGP\n4ZV)LVD\nBTP)RMR\n73H)VKW\nSB2)19H\n2G5)2C3\nK31)LL4\nL97)M9G\nK3T)CCC\nPJH)FDM\nCRV)8S2\nDMC)P13\nTGP)4RR\nY7M)QZC\n8PP)RZH\nKY3)VR2\n646)K7L\n1VR)QQP\nGK3)RT5\n1DN)XZJ\n5FW)D9Y\nHNF)M9C\nX5T)Q41\nLQP)FVG\nMTB)DW1\nLFF)3J6\n8X5)YHV\nG3X)NP1\nZ5D)X13\n63G)3LZ\n6C8)WKF\n5TV)HLC\nRW7)ZX4\nJ4H)9NZ\nKBZ)1VR\n4CR)MK7\nLZG)BV7\nB6Z)QKB\n798)VXY\nQM2)11D\nHLD)RSX\n6C2)YZX\nMTB)6LH\nGCH)P94\n3DY)SKG\nCV3)L97\n86B)YZF\n3X8)3KW\n95T)GXB\n44D)BD7\nX4N)M3P\n8ZW)C4C\nQPQ)63V\nS36)DGZ\nBCB)BTF\n2ZW)XTP\nHJQ)G6V\nXW3)XYT\nWSR)S8R\n79C)TKC\n9D6)N7L\nHV6)MCN\n58M)XR3\nJRL)2PT\nPHM)24R\n2S6)SBZ\n3F9)98N\nX22)MWH\nV9D)86B\n54T)CVM\n57R)L96\nG6N)N7Y\n6M8)6WT\nDLC)Q8R\nSN6)LRD\n9ZQ)FKJ\nT2K)GDV\n9TR)697\nYZG)RVG\nTZH)37N\nZJY)YFF\nSKG)5SL\nWX4)WQ6\nZHQ)3VF\nJK9)798\nYM3)KX9\nKN6)M4N\nG7V)SY7\nPG1)VNM\nHPL)FH7\nVJN)KVF\n28T)73H\nH74)CDS\nMG3)NMG\nNWN)JFF\nD9B)3Z2\n9TL)6HC\n2HN)9S6\n1MC)9TL\nD6T)1KM\nSP9)NPS\nHVM)D6F\nVF8)634\nNS2)SG6\n91S)286\n71T)53V\nH9C)SAN\nXXX)JL1\nHQW)PNV\n6PZ)8MY\nMB1)3W2\nWQB)YBB\n446)MW5\nHZ5)J31\n8PK)L8M\nDHX)Y5X\nY4B)KBW\nB86)JVD\nBTH)HY2\nR6X)DQ1\n6GC)G9F\nKYR)689\nHV2)RZD\n775)WGC\nTRF)R11\nXFJ)Z4Y\nPXP)ZWF\nLNM)1FP\nF12)PFR\n4LC)5LN\nHMF)RML\n6DR)XSX\nRMD)NND\n3PY)5MF\nS2J)N7C\nLQT)TSJ\n697)ZYP\n2TH)2CT\nWWJ)245\nT5P)RL2\nPV7)ZWH\n98N)9GB\nSXJ)Q6P\nGC4)9Q9\n9MS)K1X\n73D)4XX\nDG2)M81\nQBD)DWL\nS8R)SVT\nTMD)H8S\nD9Z)Y96\n5Q1)LSB\nPJH)FND\nNKG)GTL\n4XY)T8V\nKXL)K3V\nPBG)TP6\nZ5X)5JQ\nJGX)87K\nK4V)TJM\nXW3)WLC\nHQK)YGL\nJ5Z)K6N\nP1C)FBD\n4K1)TC1\n8QB)LK4\nZ3P)6ZZ\nVYV)865\nCT6)FK1\nW7J)8WX\nP2C)WWJ\nRW7)HTK\n82W)FJ5\nDDY)N5Z\nVWZ)YD1\nQQB)4TC\n4SH)8X2\nG24)JP3\n32D)KDZ\nKN1)589\nFH8)JCB\nGV6)QTH\nBTH)TN1\nHC8)LQH\n83C)QYM\nH57)H31"
  val inputList = input.split("\n")
  val planets = inputList.map(parse).toList
  type Planet = (String, String)

  @scala.annotation.tailrec
  def traverse(name: String, route: List[Planet] = Nil): List[Planet] = {
    planets.find(_._2 == name) match {
      case None => throw new RuntimeException("Not found")
      case Some(p) if p._1 == "COM" => p :: route
      case Some(p) => traverse(p._1, p :: route)
    }
  }

  def parse(data: String) = {
    val dataSet = data.split(')')
    val name = dataSet(0)
    val orbit = dataSet(1)
    name -> orbit
  }

  val path1 = traverse("YOU").diff(traverse("SAN"))
  val path2 = traverse("SAN").diff(traverse("YOU"))

  print(path1.length + path2.length - 2)
}
